# Docker Deployment Guide for DrawingOCR

This guide explains how to deploy the DrawingOCR application using Docker. The application consists of a Next.js frontend and a Flask backend, both containerized for easy deployment.

## Prerequisites

- [Docker](https://docs.docker.com/get-docker/)
- [Docker Compose](https://docs.docker.com/compose/install/)

## Configuration

### Environment Variables

The application uses several environment variables for configuration. You can set these in the `docker-compose.yml` file or by creating a `.env` file.

#### Required for LLM Features (Optional)

If you want to use the LLM features for dimension extraction:

- `OPENAI_API_KEY`: Your OpenAI API key
- `CLAUDE_API_KEY`: Your Anthropic Claude API key

#### Required for Google Cloud Vision (Optional)

If you want to use Google Cloud Vision:

- `GOOGLE_APPLICATION_CREDENTIALS`: Path to your Google Cloud credentials file
- Alternatively, you can mount your credentials file as a volume

## Deployment Steps

1. **Clone the repository**

   ```bash
   git clone <repository-url>
   cd DrawingOCR
   ```

2. **Configure environment variables (optional)**

   Create a `.env` file in the root directory with your API keys:

   ```
   OPENAI_API_KEY=your-openai-api-key
   CLAUDE_API_KEY=your-claude-api-key
   ```

   Or uncomment and modify the environment variables in `docker-compose.yml`.

3. **Build and start the containers**

   ```bash
   docker-compose up -d
   ```

   This will build both the frontend and backend containers and start them in detached mode.

4. **Access the application**

   - Frontend: http://localhost:3010
   - Backend API: http://localhost:5002

## Shared Data

The frontend and backend containers share a Docker volume for uploads and results. This ensures that:

1. Files uploaded through the frontend are accessible to the backend for processing
2. Results generated by the backend are accessible to the frontend for display

## Customization

### Ports

The default ports are:
- Frontend: 3010
- Backend: 5002

To change these ports, modify the `ports` section in `docker-compose.yml`.

### Persistent Storage

By default, all data is stored in a Docker volume. If you want to use a local directory instead, modify the `volumes` section in `docker-compose.yml`:

```yaml
volumes:
  - ./data:/app/public
```

## Troubleshooting

### Container Logs

To view logs for the containers:

```bash
# Frontend logs
docker logs drawing-ocr-frontend

# Backend logs
docker logs drawing-ocr-backend
```

### Rebuilding Containers

If you make changes to the code, you'll need to rebuild the containers:

```bash
docker-compose up -d --build
```

### Stopping Containers

To stop the containers:

```bash
docker-compose down
```

To stop the containers and remove volumes:

```bash
docker-compose down -v
